---
import Layout from '../layouts/Layout.astro'
import CoachWithEditor from '../components/CoachWithEditor'

// Server-side domain detection
const host = Astro.request.headers.get('host') || ''

// Determine mode based on domain
let mode: 'prettify-landing' | 'coach-landing' | 'full' | 'editor-only' | 'coach-only' = 'prettify-landing'

if (host.includes('resumecoach.co')) {
  mode = 'coach-landing' // Resume Coach landing page
} else if (host.includes('prettify-ai.com')) {
  mode = 'prettify-landing' // Prettify AI landing page
} else if (host.includes('localhost') || host.includes('127.0.0.1')) {
  // Local dev: check env var
  const envMode = import.meta.env.PUBLIC_DEPLOYMENT_MODE
  if (envMode === 'coach-landing' || envMode === 'prettify-landing' || envMode === 'full' || envMode === 'editor-only' || envMode === 'coach-only') {
    mode = envMode
  } else {
    mode = 'coach-landing' // Default to coach landing for dev
  }
}

// Redirect for single-feature modes
if (mode === 'editor-only') {
  return Astro.redirect('/editor')
}
if (mode === 'coach-only') {
  return Astro.redirect('/coach')
}
if (mode === 'full') {
  return Astro.redirect('/coach')
}

// Determine which landing to show
const showCoachLanding = mode === 'coach-landing'
---

<Layout title={showCoachLanding ? "Resume Coach | AI-Powered Resume Tailoring" : "Prettify AI - Convert LLM Markdown to Professional DOCX & PDF"}>
  {showCoachLanding ? (
    <!-- Resume Coach Landing Page -->
    <div class="min-h-screen flex flex-col bg-gradient-to-b from-slate-50 to-white">
      <!-- Header -->
      <header class="bg-white/80 backdrop-blur-sm border-b sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
            </div>
            <span class="text-xl font-bold text-gray-900">Resume Coach</span>
          </div>
          <a href="/coach" class="inline-flex items-center justify-center rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2">
            Start Coaching
          </a>
        </div>
      </header>

      <main class="flex-1">
        <!-- Hero Section -->
        <section class="py-20 md:py-28">
          <div class="container mx-auto px-4 max-w-4xl text-center">
            <div class="inline-flex items-center gap-2 bg-primary/10 text-primary px-4 py-2 rounded-full text-sm font-medium mb-6">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
              Free AI-Powered Tool
            </div>
            <h1 class="text-4xl md:text-6xl font-bold tracking-tight text-gray-900 mb-6">
              Stop sending the<br/>
              <span class="text-primary">same resume everywhere</span>
            </h1>
            <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
              Paste a job description, chat with an AI coach, and get a resume tailored to <em>that specific job</em> in minutes.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
              <a href="/coach" class="inline-flex items-center justify-center rounded-lg font-semibold bg-primary text-primary-foreground hover:bg-primary/90 h-14 px-10 text-lg shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/30 transition-all">
                Start Coaching
                <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                </svg>
              </a>
              <a href="#how-it-works" class="inline-flex items-center justify-center rounded-lg font-semibold text-gray-700 bg-white border-2 border-gray-200 hover:border-gray-300 h-14 px-8 text-lg">
                See How It Works
              </a>
            </div>
          </div>
        </section>

        <!-- The Problem -->
        <section class="py-16 bg-white border-y">
          <div class="container mx-auto px-4 max-w-3xl">
            <div class="flex items-start gap-4 p-6 bg-amber-50 border border-amber-200 rounded-xl">
              <div class="text-3xl">ðŸ˜¤</div>
              <div>
                <h3 class="font-bold text-lg text-amber-900 mb-2">The Problem</h3>
                <p class="text-amber-800">
                  You've applied to 50 jobs with the same resume. Radio silence.
                  The truth? Recruiters spend 6 seconds scanning for <strong>specific keywords</strong> that match their job description.
                  Generic resumes get filtered out.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- How It Works -->
        <section id="how-it-works" class="py-20">
          <div class="container mx-auto px-4 max-w-5xl">
            <h2 class="text-3xl font-bold text-center mb-4">How It Works</h2>
            <p class="text-gray-600 text-center mb-12 max-w-2xl mx-auto">Three simple steps to a resume that actually gets interviews</p>

            <div class="grid md:grid-cols-3 gap-8">
              <!-- Step 1 -->
              <div class="relative">
                <div class="absolute -top-4 -left-4 w-10 h-10 rounded-full bg-primary text-white font-bold text-lg flex items-center justify-center shadow-lg">1</div>
                <div class="bg-white rounded-2xl border-2 border-gray-100 p-6 pt-8 h-full hover:border-primary/30 hover:shadow-lg transition-all">
                  <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                    </svg>
                  </div>
                  <h3 class="font-bold text-lg mb-2">Paste the Job</h3>
                  <p class="text-gray-600 text-sm">
                    Copy the job URL or paste the description. Works with Indeed, LinkedIn, Greenhouse, Lever, and more.
                  </p>
                </div>
              </div>

              <!-- Step 2 -->
              <div class="relative">
                <div class="absolute -top-4 -left-4 w-10 h-10 rounded-full bg-primary text-white font-bold text-lg flex items-center justify-center shadow-lg">2</div>
                <div class="bg-white rounded-2xl border-2 border-gray-100 p-6 pt-8 h-full hover:border-primary/30 hover:shadow-lg transition-all">
                  <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                  </div>
                  <h3 class="font-bold text-lg mb-2">Chat with Coach</h3>
                  <p class="text-gray-600 text-sm">
                    The AI analyzes what the employer wants, reviews your experience, and suggests how to frame your story.
                  </p>
                </div>
              </div>

              <!-- Step 3 -->
              <div class="relative">
                <div class="absolute -top-4 -left-4 w-10 h-10 rounded-full bg-primary text-white font-bold text-lg flex items-center justify-center shadow-lg">3</div>
                <div class="bg-white rounded-2xl border-2 border-gray-100 p-6 pt-8 h-full hover:border-primary/30 hover:shadow-lg transition-all">
                  <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mb-4">
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                  </div>
                  <h3 class="font-bold text-lg mb-2">Get Tailored Resume</h3>
                  <p class="text-gray-600 text-sm">
                    Generate a customized resume that speaks directly to this job. Export as PDF or DOCX.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- What Coach Does -->
        <section class="py-16 bg-slate-50">
          <div class="container mx-auto px-4 max-w-4xl">
            <h2 class="text-2xl font-bold text-center mb-12">What Your AI Coach Does</h2>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="flex items-start gap-4">
                <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold mb-1">Analyzes Job Requirements</h4>
                  <p class="text-sm text-gray-600">Identifies the top 3 things the employer really wants</p>
                </div>
              </div>
              <div class="flex items-start gap-4">
                <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold mb-1">Matches Your Experience</h4>
                  <p class="text-sm text-gray-600">Finds which of your achievements best fit this role</p>
                </div>
              </div>
              <div class="flex items-start gap-4">
                <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold mb-1">Suggests Framing Angles</h4>
                  <p class="text-sm text-gray-600">Technical depth? Leadership? Impact? Choose your narrative</p>
                </div>
              </div>
              <div class="flex items-start gap-4">
                <div class="w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold mb-1">Handles Gaps & Pivots</h4>
                  <p class="text-sm text-gray-600">Career gaps, short tenures, pivots - all reframed positively</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- CTA Section -->
        <section class="py-20">
          <div class="container mx-auto px-4 max-w-3xl text-center">
            <h2 class="text-3xl font-bold mb-4">Ready to stand out?</h2>
            <p class="text-gray-600 mb-8">No signup required. Start coaching in seconds.</p>
            <a href="/coach" class="inline-flex items-center justify-center rounded-lg font-semibold bg-primary text-primary-foreground hover:bg-primary/90 h-14 px-10 text-lg shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/30 transition-all">
              Start Free Coaching
              <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
              </svg>
            </a>
          </div>
        </section>
      </main>

      <!-- Footer -->
      <footer class="border-t bg-white py-6">
        <div class="container mx-auto px-4 text-center text-sm text-gray-500">
          <p>Free. No signup. <a href="https://github.com/dkeesey/prettify-ai" class="underline hover:text-primary">Open source</a>.</p>
        </div>
      </footer>
    </div>
  ) : (
  <div class="min-h-screen flex flex-col bg-gray-50">
    <!-- Minimal Header -->
    <header class="bg-white border-b">
      <div class="container mx-auto px-4 py-4 flex items-center justify-between">
        <div class="text-xl font-bold text-primary">prettify-ai.com</div>
        <a href="/editor" class="inline-flex items-center justify-center rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4">
          Open Editor
        </a>
      </div>
    </header>

    <main class="flex-1">
      <!-- Hero - The Problem/Solution -->
      <section class="bg-white border-b">
        <div class="container mx-auto px-4 py-20 max-w-4xl">
          <div class="text-center">
            <p class="text-sm font-medium text-primary mb-4 uppercase tracking-wide">Free Conversion Tool</p>
            <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-gray-900 mb-6">
              LLM output looks like this:<br/>
              <code class="text-2xl md:text-3xl bg-gray-100 px-3 py-1 rounded font-mono text-gray-600">## Experience</code>
            </h1>
            <p class="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
              Turn it into professionally styled <strong>PDF</strong> and <strong>DOCX</strong> documents in seconds.
            </p>
            <a href="/editor" class="inline-flex items-center justify-center rounded-md font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-14 px-10 text-lg">
              Start Converting
            </a>
          </div>
        </div>
      </section>

      <!-- The Flow -->
      <section class="py-16">
        <div class="container mx-auto px-4 max-w-5xl">
          <h2 class="text-2xl font-bold text-center mb-12">How It Works</h2>

          <div class="grid md:grid-cols-4 gap-6">
            <!-- Step 1: Paste -->
            <div class="text-center">
              <div class="w-12 h-12 rounded-full bg-gray-200 text-gray-600 font-bold flex items-center justify-center mx-auto mb-3">1</div>
              <h3 class="font-semibold mb-1">Paste</h3>
              <p class="text-sm text-gray-500">Markdown from ChatGPT, Claude, or bookmarklet</p>
            </div>

            <!-- Step 2: Convert -->
            <div class="text-center">
              <div class="w-12 h-12 rounded-full bg-gray-200 text-gray-600 font-bold flex items-center justify-center mx-auto mb-3">2</div>
              <h3 class="font-semibold mb-1">Convert</h3>
              <p class="text-sm text-gray-500">Instantly renders as formatted document</p>
            </div>

            <!-- Step 3: SELECT THEME - THE HERO -->
            <div class="text-center md:scale-110 relative">
              <div class="absolute inset-0 bg-primary/10 rounded-2xl -m-4 md:block hidden"></div>
              <div class="relative">
                <div class="w-14 h-14 rounded-full bg-primary text-white font-bold text-xl flex items-center justify-center mx-auto mb-3 shadow-lg">3</div>
                <h3 class="font-bold text-lg text-primary mb-2">Select Theme</h3>
                <!-- Mini theme selector preview -->
                <div class="inline-flex items-center gap-2 bg-white border-2 border-primary rounded-lg px-3 py-2 shadow-md">
                  <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                  </svg>
                  <span class="text-sm font-medium">Classic Serif</span>
                  <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                  </svg>
                </div>
                <p class="text-xs text-gray-500 mt-2">Transforms instantly</p>
              </div>
            </div>

            <!-- Step 4: Export -->
            <div class="text-center">
              <div class="w-12 h-12 rounded-full bg-gray-200 text-gray-600 font-bold flex items-center justify-center mx-auto mb-3">4</div>
              <h3 class="font-semibold mb-1">Export</h3>
              <p class="text-sm text-gray-500">Download as PDF or DOCX</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Output Formats Explained -->
      <section class="bg-white border-y py-16">
        <div class="container mx-auto px-4 max-w-4xl">
          <h2 class="text-2xl font-bold text-center mb-12">Two Outputs, Different Purposes</h2>

          <div class="grid md:grid-cols-2 gap-8">
            <div class="p-6 rounded-xl border-2 border-gray-200">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 bg-blue-100 rounded-lg">
                  <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold">DOCX</h3>
              </div>
              <p class="text-gray-600 mb-4">For job portals and ATS systems. Simple formatting that machines can parse.</p>
              <ul class="text-sm text-gray-500 space-y-1">
                <li>Upload to LinkedIn, Indeed, Workday</li>
                <li>ATS-friendly structure</li>
                <li>Editable in Word or Google Docs</li>
              </ul>
            </div>

            <div class="p-6 rounded-xl border-2 border-primary bg-primary/5">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 bg-primary/20 rounded-lg">
                  <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                </div>
                <h3 class="text-xl font-bold">PDF</h3>
              </div>
              <p class="text-gray-600 mb-4">For humans. Beautiful formatting exactly as you see it on screen.</p>
              <ul class="text-sm text-gray-500 space-y-1">
                <li>Email directly to recruiters</li>
                <li>Attach to personal applications</li>
                <li>Print for interviews</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Common Use Case -->
      <section class="py-16">
        <div class="container mx-auto px-4 max-w-3xl text-center">
          <p class="text-sm font-medium text-gray-500 mb-4">COMMON USE CASE</p>
          <h2 class="text-2xl font-bold mb-6">AI-Generated Resumes</h2>
          <p class="text-gray-600 mb-8">
            You asked ChatGPT or Claude to write your resume. It gave you great content in markdown format.
            Now you need it in a format you can actually submit. That's what this tool does.
          </p>
          <a href="/editor" class="inline-flex items-center justify-center rounded-md font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-12 px-8">
            Try It Now
          </a>
        </div>
      </section>

      <!-- Power User Feature -->
      <section class="bg-white border-t py-12">
        <div class="container mx-auto px-4 max-w-2xl text-center">
          <h3 class="font-semibold mb-3">Power User Tip: Bookmarklet</h3>
          <p class="text-gray-600 text-sm mb-4">Drag this to your bookmark bar. Select text in ChatGPT, click it, and it opens here ready to convert.</p>
          <a
            href="javascript:(function(){var s=window.getSelection().toString();if(!s){alert('Select some text first!');return;}window.open('https://prettify-ai.com/editor?content='+btoa(unescape(encodeURIComponent(s))),'_blank');})();"
            class="inline-flex items-center gap-2 px-4 py-2 bg-gray-100 rounded border-2 border-dashed border-gray-300 hover:border-primary hover:bg-gray-50 cursor-move"
            onclick="event.preventDefault();alert('Drag this to your bookmark bar!');"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path></svg>
            Prettify It
          </a>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="border-t bg-white py-6">
      <div class="container mx-auto px-4 text-center text-sm text-gray-500">
        <p>Free. No signup. No payment. <a href="https://github.com/dkeesey/prettify-ai" class="underline hover:text-primary">Open source</a>.</p>
      </div>
    </footer>
  </div>
  )}
</Layout>
